<?xml version="1.0" encoding="UTF-8"?>
<odoo>

    <!-- Menu Principal -->
    <menuitem icon="fa-truck" id="menu_tms" name="Freights" sequence="1" web_icon="x_tms,static/description/icon.png"/>


    <!-- Menu Solicitud de Transporte -->
    <!-- <menuitem id="menu_tms_soli_r" name="Solicitud de transporte" parent="menu_tms" sequence="2"/>
    <menuitem id="menu_tms_soli" action="action_tms_request_form" name="Solicitud de transporte" parent="menu_tms_soli_r" sequence="11"/> -->
    <!--Menu fisicomecanica -->
      
    <!-- Menu Viajes -->
    <menuitem id="menu_tms_travels" name="Freights" parent="menu_tms" sequence="2"/>
    <menuitem action="open_view_tms_travel_form" id="menu_tms_travel_form" name="Travels" parent="menu_tms_travels" sequence="1"/>
    <menuitem action="action_tms_waybill_form" id="menu_tms_waybill" parent="menu_tms_travels" sequence="22" groups="x_tms.group_traffic,x_tms.group_expenses,x_tms.group_supervisor_traffic"/>
    <menuitem action="open_view_tms_advance_form" id="menu_tms_advance_form" name="Advances" parent="menu_tms_travels" sequence="23"/>
    <menuitem action="fleet.fleet_vehicle_log_fuel_action" id="fuel_vehicle_log_menu" name="Fuel Voucher" parent="menu_tms_travels" sequence="24"/>

    <menuitem action="open_view_tms_travel_template_form" id="menu_tms_travel_template_form" name="Plantilla de viaje" parent="menu_tms_travels" sequence="26"/>



    <menuitem action="action_tms_emisiones_form" id="menu_tms_emisiones" parent="fleet.fleet_vehicles"/>
    <menuitem action="action_tms_fisicomecanica_form" id="menu_tms_fisicomecanica" parent="fleet.fleet_vehicles" />
    <!-- Menu Administracion -->
    <menuitem id="menu_tms_admin" name="AdministraciÃ³n" parent="menu_tms" sequence="3"/>
   
    <menuitem action="fleet.fleet_vehicle_odometer_action" id="tms_fleet_vehicle_odometer_menu" parent="menu_tms_admin" name="Units Odometers" sequence="33"/>
    <menuitem action="action_tms_expense_loan_form" id="hr_menu_tms_expense_loan" parent="menu_tms_admin" sequence="32" />
    <menuitem action="action_tms_expense_form" id="menu_tms_expense" parent="menu_tms_admin" sequence="31"/>
    

    <record id="view_tms_travel_form" model="ir.ui.view">
        <field name="name">tms.travel.form</field>
        <field name="model">tms.travel</field>

        <field name="sequence">10</field>
        <field name="arch" type="xml">
            <form string="Travels">
                <header>
                    <button name="action_progress" icon="fa-thumbs-up" type="object"
                            string="Dispatch" states="draft" groups="x_tms.group_traffic,x_tms.group_expenses"
                            class="oe_highlight oe_read_only"/>
                    <button name="action_done" icon="fa-check-square" type="object"
                            string="Finish" states="progress" groups="x_tms.group_traffic,x_tms.group_expenses"
                            class="oe_highlight oe_read_only"/>
                    <button name="action_cancel" icon="fa-times" type="object"
                            string="Cancel" states="draft,progress" groups="x_tms.group_traffic,x_tms.group_expenses" class="oe_read_only"/>
                    <button name="action_draft" icon="fa-reply" type="object"
                            string="Set to draft" states="done,cancel" groups="x_tms.group_traffic,x_tms.group_expenses" class="oe_read_only" />
                    <button name="create_sale_order" icon="fa-check-square" type="object"
                            string="Crear Presupuesto" class="oe_highlight oe_read_only" attrs="{'invisible':[('presupuesto_creado','=',True)]}"/>
                    <button name="create_nuevo_operador" icon="fa-check-square" type="object"
                            string="Agregar nuevo operador" class="oe_highlight oe_read_only" attrs="{'invisible':[('crear_ope','=',True)]}"/>
                    <field name="state" widget="statusbar"/>
                </header>
                <sheet>
                    <div class="oe_title">
                        <h1>
                            <label class="oe_inline" style="font-size:30px;" string="Travel - " attrs="{'invisible':[('name','=', False)]}"/>
                            <field name="name" readonly="1"/>
                        </h1>
                    </div>
                    <group>
                        <group>
                            <field name="viaje_gm" attrs="{'readonly':[('state','in',('progress','done', 'closed'))]}"/>
                            <field name="fecha_viaje" attrs="{'readonly':[('state','in',('progress','done', 'closed'))]}"/>
                            <field name="subpedido_id" readonly="1"/>
                            <field name="cliente_id" attrs="{'readonly':[('state','in',('progress','done', 'closed'))]}" domain="[('customer', '=', True)]"/>
                            <field name="producto" domain="[('tms_product_category', '=',False),('es_caseta', '=', False),('es_factor_op', '=', False),('es_factor_op', '=', False),('es_combustible', '=', False),('es_cargo', '=', False),('es_flete', '=', False)]" attrs="{'readonly':[('state','in',('progress','done', 'closed'))]}"/>
                            <field name="costo_producto" />
                            <field name="sucursal_id" attrs="{'readonly':[('state','in',('progress','done', 'closed'))]}" />
                            <field name="lineanegocio" attrs="{'readonly':[('state','in',('progress','done', 'closed'))]}"/>
                            <field name="tipo_lineanegocio" readonly="1" invisible="1"/>
                            <field name="tipo_negocio" invisible="1"/>
                            
                            <field name="flete_cliente" attrs="{'readonly':[('state','in',('progress','done', 'closed'))]}"/>
                            
                            <field name="framework" invisible="1"/>                            
                            <field name="date" attrs="{'readonly':[('state','in',('progress','done', 'closed'))]}"/>
                            <field name="travels_id" attrs="{'invisible':[('crear_ope','!=',True)]}"/>
                            <field name="facturar" attrs="{'invisible':[('crear_ope','!=',True)]}"/>
                        </group>
                        <group>
                            
                            <field name="user_id" attrs="{'readonly':[('state','in',('progress','done', 'closed'))]}"/>
                            <field name="employee_id" readonly="0"/>
                            <field name="celular_operador" />
                            <field name="tipo_viaje" attrs="{'readonly':[('state','in',('progress','done', 'closed'))]}" groups="x_tms.group_travel_admon"/>
                            <field name="operating_unit_id" attrs="{'readonly':[('state','in',('progress','done', 'closed'))]}" groups="x_tms.group_travel_admon"/>
                            <field name="tipo_remolque" attrs="{'readonly':[('state','in',('progress','done', 'closed'))]}"/>
                            <field name="tipo_carga" attrs="{'readonly':[('state','in',('progress','done', 'closed'))]}"/>
                            <field name="kit_id" attrs="{'readonly':[('state','in',('progress','done','closed'))]}" domain="[('tipo_remolque','=',tipo_remolque)]"/>
                            <field name="unit_id" attrs="{'readonly':[('state','in',('progress','done', 'closed'))]}" domain="[('fleet_type', '=', 'tractor')]"/>
                            <field name="trailer1_id" attrs="{'required':['|', ('dolly_id','!=',False),('trailer2_id','!=',False)], 'readonly':[('state','in',('progress','done', 'closed'))]}" context="{'default_fleet_type': 'trailer'}" domain="[('fleet_type', '=', 'trailer'),('id','!=',trailer2_id)]" string="Remolque 1"/>
                            <field name="dolly_id" attrs="{'required':[('trailer2_id','!=',False)],'readonly':[('state','in',('progress','done', 'closed'))],'invisible':[('tipo_remolque','!=','doble')]}" context="{'default_fleet_type': 'dolly'}" domain="[('fleet_type', '=', 'dolly')]"/>
                            <field name="trailer2_id" attrs="{'required':[('dolly_id','!=',False)],'readonly':[('state','in',('progress','done', 'closed'))],'invisible':[('tipo_remolque','!=','doble')]}" context="{'default_fleet_type': 'trailer'}" domain="[('fleet_type', '=', 'trailer'),('id','!=',trailer1_id)]" string="Remolque 2"/>
                            <field name="ejes" invisible="0"/>
                            <field name="costo_casetas" invisible="1"/>
                            <field name="kml" string="Litros/km aproximados"/>
                            <field name="validar_viaje" invisible="1"/>
                            <field name="com_necesario" invisible="1"/>
                            <field name="com_solicitado" invisible="1"/>
                            <field name="presupuesto_creado" invisible="1"/>
                            <field name="odometro_inicial" invisible="1" /> 
                            <field name="odometro_final" invisible="1"/>
                            <field name="expense_id" invisible="1"/>
                            <field name="account_id" invisible="1"/>
                            <field name="crear_ope" invisible="1"/>
                        </group>
                        <group colspan="4">
                            <group colspan="4">
                                <group colspan="4">
                                    <field name="route_id" attrs="{'readonly':[('state','in',('progress','done', 'closed'))]}"/>
                                </group>
                                <group colspan="4" col="6">
                                    <field name='departure_id' />
                                    <field name="arrival_id"/>
                                    <field name="tarifa_cliente" attrs="{'readonly':[('state','in',('progress','done', 'closed'))]}"/>
                                </group>
                                <group col="6" colspan="4">
                                    <field name='modalidad_ruta1' attrs="{'readonly':[('state','in',('progress','done', 'closed'))]}"/>
                                    <field name='rendimiento_manual1' attrs="{'readonly':[('state','in',('progress','done', 'closed'))]}"/>
                                    <field name='kmlmuno' attrs="{'invisible':[('rendimiento_manual1','!=',True)],'required':[('rendimiento_manual1','=',True)],'readonly':[('state','in',('progress','done', 'closed'))]}"/>
                                </group>
                                <group col="4" colspan="4">
                                     <field name="kml_ex" />
                                     <field name="kmlextra" attrs="{'invisible':[('kml_ex','!=',True)],'required':[('kml_ex','=',True)]}"/>
                                </group>
                                <group col="6" colspan="4">
                                    <field name='combustible1'  widget="integer"/>
                                    <field name='casetas1' />
                                    <field name='flete_1' />
                                </group>
                            </group>
                            <group colspan="4">
                                <group colspan="4">
                                    <field name="route2_id" attrs="{'readonly':[('state','in',('progress','done', 'closed'))]}"/>
                                </group>
                                <group colspan="4" col="6" attrs="{'invisible':[('route2_id','=',False)]}">
                                    <field name='departure2_id'/>
                                    <field name="arrival2_id"/>
                                    <field name="tarifa_cliente2" attrs="{'readonly':[('state','in',('progress','done', 'closed'))]}"/>
                                </group>
                                <group col="6" colspan="4" attrs="{'invisible':[('route2_id','=',False)]}">
                                    <field name='modalidad_ruta2' attrs="{'readonly':[('state','in',('progress','done', 'closed'))]}"/>
                                    <field name='rendimiento_manual2' attrs="{'readonly':[('state','in',('progress','done', 'closed'))]}"/>
                                    <field name='kmlm2' attrs="{'invisible':[('rendimiento_manual2','!=',True)],'required':[('rendimiento_manual2','=',True)],'readonly':[('state','in',('progress','done', 'closed'))]}"/>
                                </group>
                                <group col="4" colspan="4">
                                     <field name="kml_ex2" />
                                     <field name="kmlextra2" attrs="{'invisible':[('route2_id','=',False)],'required':[('kml_ex2','=',True)]}"/>
                                </group>
                                <group col="6" colspan="4" attrs="{'invisible':[('route2_id','=',False)]}">
                                    <field name='combustible2'  widget="integer"/>
                                    <field name='casetas2' />
                                    <field name='flete_2' />
                                </group>
                            </group>
                        </group>
                    </group>



                    <group colspan="4" string="Servicios y Adecuaciones">
                        <group col="6" colspan="4" groups="x_tms.group_travel_admon">
                            <field name="si_seguro" />
                            <field name="condiciones_seguro" attrs="{'invisible':[('si_seguro','!=',True)],'required':[('si_seguro','=',True)]}"/>
                            <field name="cargo_seguro" attrs="{'invisible':[('si_seguro','!=',True)],'required':[('si_seguro','=',True)]}"/>
                        </group>
                        <group col="8" colspan="4">
                            <field name="lavado" />
                            <field name="cargo_lavado" attrs="{'invisible':[('lavado','!=',True)],'required':[('lavado','=',True)]}"/>
                            <field name="plastico" />
                            <field name="cargo_plastico" attrs="{'invisible':[('plastico','!=',True)],'required':[('plastico','=',True)]}"/>
                            <field name="fumigado" />
                            <field name="cargo_fumigado" attrs="{'invisible':[('fumigado','!=',True)],'required':[('fumigado','=',True)]}"/>
                        </group>
                        <group col="6" colspan="4">
                            <field name="otros" />
                            <field name="cargo_otros" attrs="{'invisible':[('otros','!=',True)],'required':[('otros','=',True)]}"/>
                            <field name="des_otros" attrs="{'invisible':[('otros','!=',True)],'required':[('otros','=',True)]}"/>
                        </group>
                    </group>
                    <group colspan="4" string="Generales Chofer">
                        <group col="8" colspan="4">
                            <field name="camisa" />
                            <field name="camisa_manga" attrs="{'invisible':[('camisa','!=',True)],'required':[('camisa','=',True)]}"/>
                            <field name="camisa_mat" attrs="{'invisible':[('camisa','!=',True)],'required':[('camisa','=',True)]}"/>
                            <field name="cargo_camisa" attrs="{'invisible':[('camisa','!=',True)],'required':[('camisa','=',True)]}"/>
                        </group>
                        <group col="6" colspan="4">
                            <field name="chaleco" />
                            <field name="chaleco_color" attrs="{'invisible':[('chaleco','!=',True)],'required':[('chaleco','=',True)]}"/>
                            <field name="cargo_chaleco" attrs="{'invisible':[('chaleco','!=',True)],'required':[('chaleco','=',True)]}"/>
                            <field name="guantes" />
                            <field name="tipo_guantes" attrs="{'invisible':[('guantes','!=',True)],'required':[('guantes','=',True)]}"/>
                            <field name="cargo_guantes" attrs="{'invisible':[('guantes','!=',True)],'required':[('guantes','=',True)]}"/>
                        </group>
                        <group col="8" colspan="4">
                            <field name="pantalon" />
                            <field name="pantalon_sua" attrs="{'invisible':[('pantalon','!=',True)],'required':[('pantalon','=',True)]}"/>
                            <field name="pantalon_mat" attrs="{'invisible':[('pantalon','!=',True)],'required':[('pantalon','=',True)]}"/>
                            <field name="cargo_pantalon" attrs="{'invisible':[('pantalon','!=',True)],'required':[('pantalon','=',True)]}"/>
                        </group>
                    </group>


                    <notebook colspan="4">
                        <page string="Vehicle log fuel">
                            <field name="fuel_log_ids" attrs="{'readonly':[('state','in',('done', 'closed'))]}" nolabel="1" context="{'default_travel_id':active_id, 'default_operating_unit_id':operating_unit_id}" >
                              <tree colors="red:state=='cancel'; green:state=='approved';blue:state=='confirmed';">
                                    <field name='name'/>
                                    <field name='operating_unit_id'/>
                                    <field name='employee_id'/>
                                    <field name='vendor_id'/>
                                    <field name='vehicle_id'/>
                                    <field name='product_id'/>
                                    <field name='product_qty'/>
                                    <field name='product_uom_id'/>
                                    <field name='price_total'/>
                                    <field name='currency_id'/>
                                    <field name='state'/>
                                </tree>
                            </field>
                        </page>
                        <page string="Advances">
                            <field name="advance_ids" attrs="{'readonly':[('state','in',('done', 'closed'))]}" context="{'default_travel_id':active_id, 'default_operating_unit_id': operating_unit_id, 'default_employee_id': employee_id}" nolabel="1">
                                <tree editable="bottom">
                                    <field name="id" invisible="1"/>
                                    <field name="name" />
                                    <field name="notes" invisible="1" />
                                    <field name="advance_auto" invisible="1" />
                                    <field name="adelanto_factor" invisible="1" />
                                    <field name="operating_unit_id" />
                                    <field name="unit_id" />
                                    <field name="employee_id" />
                                    <field name="date" />
                                    <field name="product_id" />
                                    <field name="amount" />
                                    <field name="paid" />
                                    <field name="state" />
                                    <field name="move_id" invisible="1"/>
                                    <field name="expense_id" invisible="1"/>
                                    <field name="cuenta_b" invisible="1"/>
                                    <field name="adjunto_compro" invisible="1" />
                                    <field name="paid" invisible="1"/>
                                    <field name="payment_move_id" invisible="1"/>
                                    <field name="n_transaccion" invisible="1"/>
                                    <field name="auto_expense" invisible="1"/>
                                    <field name="to_expense"/>
                                </tree>
                            </field>
                        </page>
                        <page string="Expense driver factor">
                            <field name="driver_factor_ids" attrs="{'readonly':[('state','in',('done', 'closed'))]}" context="{'default_category': 'driver'}" nolabel="1">
                                <tree>
                                    <field name="name" />
                                    <field name="factor_type" />
                                    <field name="valor" />
                                    <field name="if_diferentes" />
                                    <field name="valor2" />
                                    <field name="total" />
                                    <field name="travel_id" invisible="1" />
                                </tree>
                            </field>
                        </page>
                        <page string="Productos" >
                            <group>
                                <field name="product" nolabel="1">
                                    <tree delete="false" create="false" edit="false">
                                        <field name="product_id" />
                                        <field name="name" />
                                        <field name="product_uom_qty" />
                                        <field name="price_unit" />
                                        <field name="tax_id" />
                                        <field name="price_subtotal" />
                                    </tree>
                                </field>
                            </group>
                        </page>
                        <page string="Pesos" attrs="{'invisible':[('tipo_negocio','=','flete')]}">
                            <group>
                                <group string="Peso Origen">
                                    <field name="peso_origen_remolque_1" attrs="{'readonly':[('state','in',('progress','done', 'closed'))]}"/>
                                    <field name="peso_origen_remolque_2" attrs="{'invisible':[('tipo_remolque','!=','doble')],'readonly':[('state','in',('progress','done', 'closed'))]}"/>
                                    <field name="peso_origen_total" attrs="{'readonly':[('state','in',('progress','done', 'closed'))]}"/>
                                </group>
                                <group string="Peso Destino">
                                    <field name="peso_destino_remolque_1" attrs="{'readonly':[('state','in',('progress','done', 'closed'))]}"/>
                                    <field name="peso_destino_remolque_2" attrs="{'invisible':[('tipo_remolque','!=','doble')],'readonly':[('state','in',('progress','done', 'closed'))]}"/>
                                    <field name="peso_destino_total" attrs="{'readonly':[('state','in',('progress','done', 'closed'))]}"/>
                                    <field name="peso_autorizado" attrs="{'readonly':[('state','in',('progress','done', 'closed'))]}"/>
                                </group>
                                <group string="Peso Convenido">
                                    <field name="peso_convenido_remolque_1" attrs="{'readonly':[('state','in',('progress','done', 'closed'))]}"/>
                                    <field name="peso_convenido_remolque_2" attrs="{'invisible':[('tipo_remolque','!=','doble')],'readonly':[('state','in',('progress','done', 'closed'))]}"/>
                                    <field name="peso_convenido_total" attrs="{'readonly':[('state','in',('progress','done', 'closed'))]}"/>
                                </group>
                            </group>
                            <group>
                                <group string="Merma">
                                    <field name="facturar_con" invisible="1"/>
                                    <field name="facturar_con_cliente"/>
                                    <field name="excedente_merma"/>
                                    <field name="merma_kg"/>
                                    <field name="merma_pesos"/>
                                    <field name="merma_permitida_kg"/>
                                    <field name="merma_permitida_pesos"/>
                                    <field name="merma_cobrar_kg"/>
                                    <field name="merma_cobrar_pesos"/>

                                </group>
                                <!-- <group string="ComisiÃ³n">
                                    <field name="comision_linea"/>
                                    <field name="regla_comision"/>
                                    <field name="comision_calculada"/>
                                    <field name="motivo"/>
                                    <field name="porcent_comision"/>
                                    <field name="cant_especifica"/>
                                    <field name="maniobras"/>
                                    <field name="regla_maniobra"/>
                                    <field name="pronto_pago"/>

                                </group> -->
                            </group>
                        </page>
                        


                        <page string="Evidencias" >
                            <group>
                                <field name="evidencias_id" nolabel="1"/>
                                <field name="documentacion_completa" />
                                <field name="fecha_documentacion" />
                                <!-- <field name="dif_dias" /> -->
                                <field name="asignadoa_id" />
                            </group>
                        </page>
                        <!-- <page string="Boletas">
                            <group>
                                <field name="boletas_id" />
                            </group>
                        </page> -->
                        <page string="CARTA DE INSTRUCCIÃN">
                            <group>
                                <field name="detalle_origen" string="Detalle Origen"/>
                                <field name="detalle_destino" string="Detalle Destino"/>
                            </group>
                        </page>

                        <page string="Cita">
                            <group>
                                <field name="fecha_hora_carga" />
                                <field name="fecha_hora_descarga" />
                                <field name="detalles_cita" />
                            </group>
                        </page>

                        <page string="Gastos Reales">
                            <group>
                                <field name="cargo_id" context="{'default_line_cargo_id':active_id}" nolabel="1">
                                    <tree editable="bottom">
                                        <field name="name" required="1" />
                                        <field name="valor" required="1" />
                                        <field name="sistema" />
                                        <field name="advance_id" />
                                        <field name="adjunto_compro" readonly="0" widget="binary" filename="filename"/>
                                        <field name="filename" invisible="1"/>
                                        <field name="line_cargo_id" invisible="1"/>
                                        <field name="state" invisible="0" readonly="1"/>

                                    <button name="action_aprove" type="object" string="Aprobar" attrs="{'invisible':[('state','in',('rechazado','aprobado'))]}" />
                                    <button name="action_cancel" type="object" string="Rechazar" attrs="{'invisible':[('state','in',('rechazado','aprobado'))]}" />
                                    </tree>
                                </field>
                            </group>
                        </page>

                        <page string="Calificaciones">
                            <group>
                                <field name="calificaiones" nolabel="1" context="{'default_viaje_id':active_id}">
                                    <tree>
                                        <field name="viaje_id" invisible="1"/>
                                        <field name="clasificacion_id"/>
                                        <field name="operador_nombre" />
                                        <field name="considerar" />
                                    </tree>
                                </field>
                            </group>
                        </page>
                        <!-- <page string="SLI TRACK">
                        <hr/>
                          <div>
                                   <button string="Generar c&#243;digo" name="action_slitrack_codigo" type="object" class="oe_inline oe_stat_button" confirm="&#191;Generar c&#243;digo?"/>
                                   <span style="width:100%;"/><span style="color:white;">|</span>
                                   <button string="Activar" name="action_slitrack_activa" type="object" class="oe_inline oe_stat_button" confirm="&#191;Activar viaje?"/>
                                 </div>
                                 <hr/>
                             <group>
                               <group>
                               </group>
                               <group/>
                               <group name="slitrack_gps" string="GPS">
                                 <field name="slitrack_gps_fechahorar" readonly="0"/>
                                 <field name="slitrack_gps_latitud" readonly="0"/>
                                 <field name="slitrack_gps_longitud" readonly="0"/>
                                 <field name="slitrack_gps_velocidad" readonly="0"/>
                                 <field name="slitrack_gps_contador" readonly="0"/>

                               </group>
                               <group name="slitrack_control" string="Control">
                                 <field name="slitrack_proveedor"/>
                                 <field name="slitrack_estado"/>
                                 <field name="slitrack_codigo" readonly="1"/>
                                 <field name="slitrack_st"/>
                                 <field name="slitrack_comentarios"/>
                               </group>
                             </group>
                        </page> -->
                        <page string="Detalles">
                            <group>
                                <field name="observaciones" />
                                <field name="especificaciones" />
                                <field name="folio_cliente" />
                                <field name="suger_pago" />
                            </group>
                        </page>
                        
                        <page string="Waybills">
                            <group>
                                <field name="waybill_ids" attrs="{'readonly':[('state','in',('done', 'closed'))]}" nolabel="1">
                                    <tree colors="red:state=='cancel';green:state=='approved';blue:state=='confirmed';" string="Waybills">
                                        <button groups="x_tms.group_waybill_approve" icon="gtk-go-forward" name="action_approve" states="draft" string="Approve" type="object"/>
                                        <button groups="x_tms.group_waybill_confirm" icon="gtk-ok" name="action_confirm" states="approved" string="Confirm" type="object"/>
                                        <field name="state"/>
                                        <field name="name"/>
                                        <field name="date_order"/>
                                        <field name="partner_id"/>
                                        <field name="product_qty" sum="Product Quantity"/>
                                        <field name="amount_untaxed" sum="Amount Untaxed"/>
                                        <field name="amount_tax" sum="Taxes"/>
                                        <field name="amount_total" sum="Total "/>
                                    </tree>
                                </field>
                            </group>
                        </page>
                        
                        <page string="History">
                            <field name="event_ids" context="{'default_travel_id':active_id}" nolabel="1"/>
                            <group>
                                <separator colspan="4" string="Notes"/>
                                <field attrs="{'readonly':[('state','in',('done', 'closed'))]}" name="notes" nolabel="1"/>
                            </group>
                        </page>
                        <page string="Statistics">
                            <group>
                                <group>
                                    <separator string="Distances (mi./kms)"/>
                                    <newline/>
                                    <field name="distance_route" readonly="1"/>
                                    <field attrs="{'readonly':[('state','in',('done', 'closed'))]}" name="distance_loaded"/>
                                    <field attrs="{'readonly':[('state','in',('done', 'closed'))]}" name="distance_empty"/>
                                    <field name="distance_driver"/>
                                    <field name="odometer" attrs="{'invisible':[('state','!=', 'done', 'closed')]}"/>
                                </group>
                                <group>
                                    <separator colspan="4" string="Fuel Efficiency"/>
                                    <newline/>
                                    <field attrs="{'readonly':[('state','in',('done', 'closed'))]}" name="fuel_efficiency_expected"/>
                                    <field attrs="{'readonly':[('state','in',('done', 'closed'))]}" name="fuel_efficiency_travel"/>
                                    <field name="fuel_efficiency_extraction"/>
                                </group>
                            </group>
                            <separator colspan="4" string="Date and Times"/>
                            <group col="6" colspan="4">
                                <field attrs="{'readonly':[('state','in',('done', 'closed'))]}" name="date_start" />
                                <field attrs="{'readonly':[('state','in',('done', 'closed'))]}" name="date_end" />
                                <field attrs="{'readonly':[('state','in',('done', 'closed'))]}" name="travel_duration" widget="float_time"/>
                                <field attrs="{'readonly':[('state','in',('done', 'closed'))]}" name="date_start_real" />
                                <field attrs="{'readonly':[('state','in',('done', 'closed'))]}" name="date_end_real" />
                                <field attrs="{'readonly':[('state','in',('done', 'closed'))]}" name="travel_duration_real" widget="float_time"/>
                            </group>
                        </page>
                        <page string="Cruce">
                            <group colspan="4">
                                <field name="file_casetas" readonly="0" widget="binary" filename="filename"/>
                                <field name="filename" invisible="1"/>
                                
                            </group>
                            <group colspan="4" invisible="0" string="Casetas Registradas">
                                <field name="cruce_casetas" nolabel="1">
                                    <tree  string="Cruces">
                                        <field name="name"/>
                                        <field name="unidad"/>
                                        <field name="fecha"/>
                                        <field name="hora"/>
                                        <field name="caseta"/>
                                        <field name="caseta_id"/>
                                        <field name="marcada"/>
                                        <field name="travel_id" invisible="1"/>
                                    </tree>
                                </field>
                            </group>
                            <group colspan="4"  string="Casetas No Registradas">
                                <field name="cruce_casetas_faltantes" nolabel="1">
                                    <tree  string="Cruces">
                                        <field name="name"/>
                                        <field name="unidad"/>
                                        <!-- <field name="fecha"/>
                                        <field name="hora"/> -->
                                        <field name="caseta"/>
                                        <field name="caseta_id"/>
                                        <field name="travel2_id" invisible="1"/>
                                    </tree>
                                </field>
                            </group>
                            <group colspan="4" invisible="0" string="Casetas Esperadas">
                                <field name="cruce_casetas_planeado" nolabel="1">
                                    <tree  string="Cruces">
                                        <field name="name"/>
                                        <field name="unidad"/>
                                        <!-- <field name="fecha"/>
                                        <field name="hora"/> -->
                                        <field name="caseta"/>
                                        <field name="caseta_id"/>
                                        <field name="marcada"/>
                                        <field name="travel2_id" invisible="1"/>
                                    </tree>
                                </field>
                            </group>
                        </page>
                    </notebook>
                </sheet>
                <div class="oe_chatter">
                    <field name="message_follower_ids" widget="mail_followers"/>
                    <field name="message_ids" placeholder="Share a message..." widget="mail_thread"/>
                </div>
            </form>
        </field>
    </record>
    <record id="open_view_tms_travel_report" model="ir.actions.act_window">
        <field name="name">TMS Travel</field>
        <field name="res_model">tms.travel</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree,form,gantt,graph</field>
        <field name="view_id" ref="view_tms_travel_tree_report"/>
        <field name="context">{&quot;search_default_progress&quot;:1, 'search_default_date_dispatched': 1}</field>
    </record>


    <!-- Menu Reportes -->
    <menuitem id="menu_tms_reports" name="Reports" parent="menu_tms" sequence="4"/>
    <menuitem action="open_view_tms_travel_report" id="menu_tms_travel_report" name="Travels" parent="menu_tms_reports" sequence="41"/>
    <menuitem action="open_view_tms_event_form" id="menu_tms_event_report" name="Eventos" parent="menu_tms_reports" sequence="46"/>

    <!-- Menu Settings Principal -->
    <menuitem id="menu_tms_settings" name="Configuration" parent="menu_tms" sequence="9"/>

    <record id="action_lineasnegocio_tms" model="ir.actions.act_window">
        <field name="name">Lineas del negocio</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">tms.lineanegocio</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree,form</field>
        <field name="domain">[]</field>
        <field name="filter" eval="True"/>
    </record>
    <menuitem id="menu_tms_settings_lineasnegocio" action="action_lineasnegocio_tms" name="Lineas de Negocio" parent="menu_tms_settings" sequence="10"/>


    <!-- SubMenu 1 -->
    <record id="action_partner_tms" model="ir.actions.act_window">
        <field name="name">Clientes</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">res.partner</field>
        <field name="view_type">form</field>
        <field name="view_mode">kanban,tree,form</field>
        <field name="domain">[('customer','=',True)]</field>
        <field name="filter" eval="True"/>
    </record>
    <menuitem id="menu_tms_settings_partners" name="Clientes" parent="menu_tms_settings" sequence="101"/>
    <menuitem id="menu_tms_partners" name="Clientes" action="action_partner_tms" parent="menu_tms_settings_partners" sequence="1"/>

    <!-- SubMenu 2 -->
    <record id="action_partner_tms_supp" model="ir.actions.act_window">
        <field name="name">Proveedores</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">res.partner</field>
        <field name="view_type">form</field>
        <field name="view_mode">kanban,tree,form</field>
        <field name="domain">[('supplier','=',True)]</field>
        <field name="filter" eval="True"/>
    </record>
    <menuitem id="menu_tms_settings_suppliers" name="Proveedores" parent="menu_tms_settings" sequence="102"/>
     <menuitem id="menu_tms_suppliers" name="Proveedores" action="action_partner_tms_supp" parent="menu_tms_settings_suppliers" sequence="1"/>


     <!-- SubMenu 3 -->
    <menuitem id="menu_tms_settings_operators" name="Operadores" parent="menu_tms_settings" sequence="103"/>
    <menuitem action="tms_open_view_employee_list" id="menu_tms_open_view_employee_list" name="Drivers" parent="menu_tms_settings_operators" sequence="115"/>

    <!-- SubMenu 4 -->
    <menuitem id="menu_tms_settings_routes" name="Routes" parent="menu_tms_settings" sequence="104"/>
    <menuitem id="tms_route_tollstation_menu" sequence="121" name="Toll Stations" parent="menu_tms_settings_routes" action="action_tms_route_tollstation"/>
    <menuitem action="open_view_tms_route_form" id="menu_tms_settings_route_form" name="Routes" parent="menu_tms_settings_routes" sequence="122"/>
    <menuitem action="open_view_tms_place_form" id="menu_tms_settings_route_place_form" name="Places" parent="menu_tms_settings_routes" sequence="123"/>

    <!-- SubMenu 5 -->
    <record id="action_product_category_tms" model="ir.actions.act_window">
        <field name="name">Categorias de Productos</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">product.category</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree,form</field>
        <field name="domain"></field>
        <field name="filter" eval="True"/>
    </record>
    <menuitem id="menu_tms_settings_products" name="Categorias de Productos" parent="menu_tms_settings" sequence="105"/>
    <menuitem action="action_product_category_tms" id="menu_tms_open_view_product_list" name="Categorias de Productos" parent="menu_tms_settings_products" sequence="119"/>

    <!-- <menuitem action="tms_open_view_product_list" id="menu_tms_open_view_product_list" name="Products" parent="menu_tms_settings_products" sequence="119"/> -->

    <!-- Records de direccionamiento -->
    <record id="tms_open_view_products_list" model="ir.actions.act_window">
        <field name="name">Productos/Servicios</field>
        <field name="res_model">product.product</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree,form</field>
        <field eval="False" name="view_id"/>
    </record>

    <record id="tms_open_view_product_list1" model="ir.actions.act_window">
        <field name="name">Fletes</field>
        <field name="res_model">product.template</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree,form</field>
        <field name="domain">[('tms_product_category', '=', 'freight')]</field>
        <field name="context">{'default_tms_product_category': 'freight'}</field>
        <field eval="False" name="view_id"/>
    </record>
    <record id="tms_open_view_product_list2" model="ir.actions.act_window">
        <field name="name">Movimientos</field>
        <field name="res_model">product.template</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree,form</field>
        <field name="domain">[('tms_product_category', '=', 'move')]</field>
        <field name="context">{'default_tms_product_category': 'move'}</field>
        <field eval="False" name="view_id"/>

    </record>
    <record id="tms_open_view_product_list3" model="ir.actions.act_window">
        <field name="name">Seguros</field>
        <field name="res_model">product.template</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree,form</field>
        <field name="domain">[('tms_product_category', '=', 'insurance')]</field>
        <field name="context">{'default_tms_product_category': 'insurance'}</field>
        <field eval="False" name="view_id"/>
    </record>
    <record id="tms_open_view_product_list4" model="ir.actions.act_window">
        <field name="name">Casetas</field>
        <field name="res_model">product.template</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree,form</field>
        <field name="domain">[('tms_product_category', '=', 'tolls')]</field>
        <field name="context">{'default_tms_product_category': 'tolls'}</field>
        <field eval="False" name="view_id"/>
    </record>
    <record id="tms_open_view_product_list5" model="ir.actions.act_window">
        <field name="name">Otro</field>
        <field name="res_model">product.template</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree,form</field>
        <field name="domain">[('tms_product_category', '=', 'other')]</field>
        <field name="context">{'default_tms_product_category': 'other'}</field>
        <field eval="False" name="view_id"/>
    </record>
    <record id="tms_open_view_product_list6" model="ir.actions.act_window">
        <field name="name">Gasto Real</field>
        <field name="res_model">product.template</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree,form</field>
        <field name="domain">[('tms_product_category', '=', 'real_expense')]</field>
        <field name="context">{'default_tms_product_category': 'real_expense'}</field>
        <field eval="False" name="view_id"/>
    </record>
    <record id="tms_open_view_product_list7" model="ir.actions.act_window">
        <field name="name">Gasto Falso</field>
        <field name="res_model">product.template</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree,form</field>
        <field name="domain">[('tms_product_category', '=', 'made_up_expense')]</field>
        <field name="context">{'default_tms_product_category': 'made_up_expense'}</field>
        <field eval="False" name="view_id"/>
    </record>
    <record id="tms_open_view_product_list8" model="ir.actions.act_window">
        <field name="name">Salario</field>
        <field name="res_model">product.template</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree,form</field>
        <field name="domain">[('tms_product_category', '=', 'salary')]</field>
        <field name="context">{'default_tms_product_category': 'salary'}</field>
        <field eval="False" name="view_id"/>
    </record>
    <record id="tms_open_view_product_list9" model="ir.actions.act_window">
        <field name="name">RetenciÃ³n de Salario</field>
        <field name="res_model">product.template</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree,form</field>
        <field name="domain">[('tms_product_category', '=', 'salary_retention')]</field>
        <field name="context">{'default_tms_product_category': 'salary_retention'}</field>
        <field eval="False" name="view_id"/>
    </record>
    <record id="tms_open_view_product_list10" model="ir.actions.act_window">
        <field name="name">Descuento de Salario</field>
        <field name="res_model">product.template</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree,form</field>
        <field name="domain">[('tms_product_category', '=', 'salary_discount')]</field>
        <field name="context">{'default_tms_product_category': 'salary_discount'}</field>
        <field eval="False" name="view_id"/>
    </record>
    <record id="tms_open_view_product_list11" model="ir.actions.act_window">
        <field name="name">Combustible</field>
        <field name="res_model">product.template</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree,form</field>
        <field name="domain">[('tms_product_category', '=', 'fuel')]</field>
        <field name="context">{'default_tms_product_category': 'fuel'}</field>
        <field eval="False" name="view_id"/>
    </record>
    <record id="tms_open_view_product_list12" model="ir.actions.act_window">
        <field name="name">Otro Ingreso</field>
        <field name="res_model">product.template</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree,form</field>
        <field name="domain">[('tms_product_category', '=', 'other_income')]</field>
        <field name="context">{'default_tms_product_category': 'other_income'}</field>
        <field eval="False" name="view_id"/>
    </record>
    <record id="tms_open_view_product_list13" model="ir.actions.act_window">
        <field name="name">Reembolso</field>
        <field name="res_model">product.template</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree,form</field>
        <field name="domain">[('tms_product_category', '=', 'refund')]</field>
        <field name="context">{'default_tms_product_category': 'refund'}</field>
        <field eval="False" name="view_id"/>
    </record>
    <record id="tms_open_view_product_list14" model="ir.actions.act_window">
        <field name="name">Balance Negativo</field>
        <field name="res_model">product.template</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree,form</field>
        <field name="domain">[('tms_product_category', '=', 'negative_balance')]</field>
        <field name="context">{'default_tms_product_category': 'negative_balance'}</field>
        <field eval="False" name="view_id"/>
    </record>
    <record id="tms_open_view_product_list15" model="ir.actions.act_window">
        <field name="name">Combustible en efectivo</field>
        <field name="res_model">product.template</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree,form</field>
        <field name="domain">[('tms_product_category', '=', 'fuel_cash')]</field>
        <field name="context">{'default_tms_product_category': 'fuel_cash'}</field>
        <field eval="False" name="view_id"/>
    </record>
    <record id="tms_open_view_product_list16" model="ir.actions.act_window">
        <field name="name">Casetas (Liquidaciones)</field>
        <field name="res_model">product.template</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree,form</field>
        <field name="domain">[('tms_product_category', '=', 'tollstations')]</field>
        <field name="context">{'default_tms_product_category': 'tollstations'}</field>
        <field eval="False" name="view_id"/>
    </record>
    <record id="tms_open_view_product_list17" model="ir.actions.act_window">
        <field name="name">PrÃ©stamo</field>
        <field name="res_model">product.template</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree,form</field>
        <field name="domain">[('tms_product_category', '=', 'loan')]</field>
        <field name="context">{'default_tms_product_category': 'loan'}</field>
        <field eval="False" name="view_id"/>
    </record>
    <record id="tms_open_view_product_list18" model="ir.actions.act_window">
        <field name="name">Productos Transportables</field>
        <field name="res_model">product.template</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree,form</field>
        <field name="domain">[('tms_product_category', '=', 'charge')]</field>
        <field name="context">{'default_tms_product_category': 'charge'}</field>
        <field eval="False" name="view_id"/>
    </record>

    <menuitem id="menu_tms_settings_r_carta" name="Productos/Servicios" parent="menu_tms_settings" sequence="106"/>
    <menuitem action="tms_open_view_products_list" id="menu_tms_open_view_products" name="Productos/Servicios" parent="menu_tms_settings_r_carta" sequence="1"/>
    <menuitem action="action_tms_viaje_cargos_adicionales_form" id="menu_tms_open_view_cargo_viajes_adicionales" name="Tipos de cargos adicionales" parent="menu_tms_settings_r_carta" sequence="2"/>
    <!-- SubMenu 6 -->
    <!-- <menuitem id="menu_tms_settings_r_carta" name="Relacionado a Carta Porte" parent="menu_tms_settings" sequence="106"/>
    <menuitem action="tms_open_view_product_list1" id="menu_tms_open_view_product_list1" name="Producto Flete" parent="menu_tms_settings_r_carta" sequence="1"/>
    <menuitem action="tms_open_view_product_list2" id="menu_tms_open_view_product_list2" name="Maniobras de Carga/Descarga" parent="menu_tms_settings_r_carta" sequence="2"/>
    <menuitem action="tms_open_view_product_list3" id="menu_tms_open_view_product_list3" name="Seguro de carga" parent="menu_tms_settings_r_carta" sequence="3"/> -->
    <!-- <menuitem action="tms_open_view_product_list16" id="menu_tms_open_view_product_list16" name="Autopistas" parent="menu_tms_settings_r_carta" sequence="16"/> -->
    <!-- <menuitem action="tms_open_view_product_list12" id="menu_tms_open_view_product_list12" name="Otros Ingresos" parent="menu_tms_settings_r_carta" sequence="12"/>
    <menuitem action="tms_open_view_product_list18" id="tms_transportable_menu" name="Productos Transportables" parent="menu_tms_settings_r_carta" sequence="100"/> -->

    <!-- SubMenu 7 -->
    <!-- <menuitem id="menu_tms_settings_liquidac" name="LiquidaciÃ³n" parent="menu_tms_settings" sequence="107"/> -->
    <!-- <menuitem action="tms_open_view_product_list4" id="menu_tms_open_view_product_list4" name="Casetas" parent="menu_tms_settings_liquidac" sequence="4"/> -->
  <!--   <menuitem action="tms_open_view_product_list5" id="menu_tms_open_view_product_list5" name="Otro" parent="menu_tms_settings_liquidac" sequence="5"/>
    <menuitem action="tms_open_view_product_list6" id="menu_tms_open_view_product_list6" name="Concepto de Gasto" parent="menu_tms_settings_liquidac" sequence="6"/>
    <menuitem action="tms_open_view_product_list7" id="menu_tms_open_view_product_list7" name="Gastos Indirectos" parent="menu_tms_settings_liquidac" sequence="7"/>
    <menuitem action="tms_open_view_product_list8" id="menu_tms_open_view_product_list8" name="Sueldo Operador" parent="menu_tms_settings_liquidac" sequence="8"/>
    <menuitem action="tms_open_view_product_list9" id="menu_tms_open_view_product_list9" name="RetenciÃ³n de Salario" parent="menu_tms_settings_liquidac" sequence="9"/>
    <menuitem action="tms_open_view_product_list10" id="menu_tms_open_view_product_list10" name="Descuento de Salario" parent="menu_tms_settings_liquidac" sequence="10"/>
    <menuitem action="tms_open_view_product_list11" id="menu_tms_open_view_product_list11" name="Combustible" parent="menu_tms_settings_liquidac" sequence="11"/> -->

    <!-- <menuitem action="tms_open_view_product_list13" id="menu_tms_open_view_product_list13" name="Reembolso" parent="menu_tms_settings_liquidac" sequence="13"/>
    <menuitem action="tms_open_view_product_list14" id="menu_tms_open_view_product_list14" name="Balance en Contra" parent="menu_tms_settings_liquidac" sequence="14"/>
    <menuitem action="tms_open_view_product_list15" id="menu_tms_open_view_product_list15" name="Combustible en efectivo" parent="menu_tms_settings_liquidac" sequence="15"/>

    <menuitem action="tms_open_view_product_list17" id="menu_tms_open_view_product_list17" name="Facilidad Administrativa" parent="menu_tms_settings_liquidac" sequence="17"/> -->

    <!-- SubMenu 8 -->
    <menuitem id="menu_tms_settings_eve_acc" name="Eventos y Acciones" parent="menu_tms_settings" sequence="108"/>
    <menuitem action="action_fleet_vehicle_tms" id="tms_fleet_vehicle_menu" name="Units" parent="menu_tms_settings_eve_acc" sequence="116"/>
    <menuitem action="open_view_tms_unit_kit_form" id="menu_tms_config_unit_kit_form" name="Units Kits" parent="menu_tms_settings_eve_acc" sequence="125"/>

    <!-- SubMenu 9 -->
    <menuitem id="menu_tms_settings_conf_ve" name="ConfiguraciÃ³n de VehÃ­culos" parent="menu_tms_settings" sequence="109"/>
    <menuitem action="fleet.fleet_vehicle_state_action" groups="fleet.fleet_group_manager" id="tms_fleet_vehicle_state_menu" parent="menu_tms_settings_conf_ve" sequence="111"/>
    <menuitem action="fleet.fleet_vehicle_model_action" id="tms_fleet_vehicle_model" parent="menu_tms_settings_conf_ve" sequence="113"/>
    <menuitem action="fleet.fleet_vehicle_model_brand_action" id="tms_fleet_vehicle_make" parent="menu_tms_settings_conf_ve" sequence="114"/>    <menuitem id="fleet_vehicle_engine_menu" sequence="117" name="Engines" parent="menu_tms_settings_conf_ve" action="action_fleet_vehicle_engine"/>

    <!-- SubMenu 10 -->
    <!-- <menuitem id="menu_tms_settings_fact" name="Factores" parent="menu_tms_settings" sequence="110"/>
    <menuitem id="menu_tms_fact" name="Factores de Ruta" action="open_view_tms_factor_form" parent="menu_tms_settings_fact" sequence="110"/> -->


    <menuitem action="open_view_fleet_vehicle_log_fuel_prepaid_form" id="menu_fleet_vehicle_log_fuel_prepaid_form" name="Fuel Prepaid" parent="menu_tms_settings" sequence="100"/>
    <menuitem id="menu_custom_config" name="Settings" parent="menu_tms_settings"
    sequence="100" action="action_tms_config"/>
    <!-- <menuitem action="action_tms_custom_house" id="tms_custom_house" parent="menu_tms_settings" name="Custom House" sequence="100"/> -->



    <!--  groups="x_tms.group_traffic,x_tms.group_expenses,x_tms.group_supervisor_traffic,base.group_system" -->
</odoo>
